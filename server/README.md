# Vencord Yandex OAuth Server

HTTP —Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Yandex OAuth –¥–ª—è –ø–ª–∞–≥–∏–Ω–∞ Vencord Yandex Music.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd server
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Yandex OAuth –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Yandex OAuth Console](https://oauth.yandex.ru/client/new)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è:
    - **–ù–∞–∑–≤–∞–Ω–∏–µ**: Vencord Yandex Music
    - **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–ª–∞–≥–∏–Ω –¥–ª—è Discord —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Yandex Music
    - **–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã**: –í—ã–±–µ—Ä–∏—Ç–µ "–í–µ–±-—Å–µ—Ä–≤–∏—Å—ã"
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:
    - `login:info` - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
    - `login:email` - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è email (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
5. –£–∫–∞–∂–∏—Ç–µ **Redirect URI**: `http://localhost:3000/oauth/callback`
6. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Client ID** - –æ–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞–≥–∏–Ω–∞

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –ø–∞–ø–∫–µ `server`:

```env
PORT=3000
YANDEX_CLIENT_SECRET=–≤–∞—à_client_secret_–µ—Å–ª–∏_–µ—Å—Ç—å
NODE_ENV=development
```

### 4. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –û–±—ã—á–Ω—ã–π –∑–∞–ø—É—Å–∫
npm start

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π)
npm run dev
```

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:3000

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞–≥–∏–Ω–∞ Vencord

1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Vencord
2. –ù–∞–π–¥–∏—Ç–µ –ø–ª–∞–≥–∏–Ω "Yandex Music"
3. –í–≤–µ–¥–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π **Client ID** –≤ –ø–æ–ª–µ "Yandex OAuth Client ID"
4. –ò–∑–º–µ–Ω–∏—Ç–µ "Redirect URI" –Ω–∞: `http://localhost:3000/oauth/callback`
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## üì° API Endpoints

### GET /

–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–µ—Ä–≤–µ—Ä–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ.

### GET /oauth/authorize

–ò–Ω–∏—Ü–∏–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**

-   `client_id` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - Client ID –≤–∞—à–µ–≥–æ Yandex OAuth –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
-   `redirect_uri` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π) - URI –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä:**

```
http://localhost:3000/oauth/authorize?client_id=YOUR_CLIENT_ID
```

### GET /oauth/callback

Endpoint –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–ª–±—ç–∫–∞ –æ—Ç Yandex OAuth.

### GET /api/user

–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–æ —Ç–æ–∫–µ–Ω—É.

**Headers:**

```
Authorization: Bearer YOUR_ACCESS_TOKEN
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

-   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è state –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç CSRF –∞—Ç–∞–∫
-   –°–µ—Å—Å–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç
-   –¢–æ–∫–µ–Ω—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ HTTPS (–≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ)

## üõ† –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞–≥–∏–Ω–æ–º

–ü–ª–∞–≥–∏–Ω –¥–æ–ª–∂–µ–Ω:

1. –û—Ç–∫—Ä—ã—Ç—å –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:

```javascript
const authWindow = window.open(
    `http://localhost:3000/oauth/authorize?client_id=${clientId}`,
    "yandexAuth",
    "width=600,height=700"
);
```

2. –°–ª—É—à–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞:

```javascript
window.addEventListener("message", (event) => {
    if (event.data.type === "YANDEX_OAUTH_SUCCESS") {
        const token = event.data.token;
        const user = event.data.user;
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω –∏ –æ–±–Ω–æ–≤–∏—Ç—å UI
    }
});
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

–°–µ—Ä–≤–µ—Ä –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—å:

-   üîÑ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ Yandex OAuth
-   üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–±—ç–∫–æ–≤
-   ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
-   ‚ùå –û—à–∏–±–∫–∏

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

-   –°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ (localhost)
-   –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è HTTPS
-   Client Secret –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Client ID —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Redirect URI –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Yandex OAuth —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `http://localhost:3000/oauth/callback`
